<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>AmpGen: /home/travis/build/GooFit/AmpGen/AmpGen/Psi3770.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AmpGen
   &#160;<span id="projectnumber">1.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dd/d66/_psi3770_8h_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Psi3770.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dd/d66/_psi3770_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d23/_normalised_pdf_8h.html">AmpGen/NormalisedPdf.h</a>&quot;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../dc/d82/namespace_amp_gen.html">AmpGen</a>;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../da/df3/namespacestd_1_1complex__literals.html">std::complex_literals</a>;</div><div class="line"><a name="l00006"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html">    6</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T1, <span class="keyword">class</span> T2&gt; <span class="keyword">class </span><a class="code" href="../../d8/d85/class_psi3770.html">Psi3770</a> {</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  <span class="keyword">private</span>:</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    <a class="code" href="../../d7/dfa/class_amp_gen_1_1_event_type.html">EventType</a>           m_signalType;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <a class="code" href="../../d7/dfa/class_amp_gen_1_1_event_type.html">EventType</a>           m_tagType;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <a class="code" href="../../d5/de1/structnormalised__pdf.html">normalised_pdf&lt;T1&gt;</a>&amp; m_signal; </div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <a class="code" href="../../d5/de1/structnormalised__pdf.html">normalised_pdf&lt;T1&gt;</a>&amp; m_signalBar; </div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <a class="code" href="../../d5/de1/structnormalised__pdf.html">normalised_pdf&lt;T2&gt;</a>&amp; m_tag; </div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <a class="code" href="../../d5/de1/structnormalised__pdf.html">normalised_pdf&lt;T2&gt;</a>&amp; m_tagBar; </div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <a class="code" href="../../d6/d53/class_amp_gen_1_1_phase_space.html">PhaseSpace</a>          m_signalPhsp;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <a class="code" href="../../d6/d53/class_amp_gen_1_1_phase_space.html">PhaseSpace</a>          m_tagPhsp;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <a class="code" href="../../d6/d53/class_amp_gen_1_1_phase_space.html">PhaseSpace</a>          m_headPhsp;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keywordtype">bool</span>                m_printed     = {<span class="keyword">false</span>};</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keywordtype">bool</span>                m_ignoreQc    = {<a class="code" href="../../d9/d1b/class_amp_gen_1_1_named_parameter.html">NamedParameter&lt;bool&gt;</a>(<span class="stringliteral">&quot;IgnoreQC&quot;</span>,<span class="keyword">false</span>)};</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordtype">size_t</span>              m_blockSize   = {1000000}; </div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; std::tuple&lt;double,double,double&gt; </div><div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html#aa81e9b7036fcfb9ad9c0b7dfe176dbaa">   22</a></span>&#160;      <a class="code" href="../../d8/d85/class_psi3770.html#aa81e9b7036fcfb9ad9c0b7dfe176dbaa">z</a>(T&amp; t1, T&amp; t2, <span class="keyword">const</span> <a class="code" href="../../d7/dfa/class_amp_gen_1_1_event_type.html">EventType</a>&amp; type)<span class="keyword"> const </span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">      </span>{</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <span class="keywordtype">double</span> n1(0), n2(0), zR(0), zI(0);</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <span class="keyword">auto</span> normEvents = <a class="code" href="../../de/d94/class_amp_gen_1_1_generator.html">Generator&lt;PhaseSpace&gt;</a>(type).generate(m_blockSize);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#pragma omp parallel for reduction(+:zR,zI,n1,n2)</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; m_blockSize; ++i){</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;          <span class="keyword">auto</span> p1 = t1(normEvents[i]);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;          <span class="keyword">auto</span> p2 = t2(normEvents[i]);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;          <span class="keyword">auto</span> f  = p2 * <a class="code" href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#af3433de0bb6eb0174187ac19b28c653f">std::conj</a>(p1);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;          zR      += std::real(f);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;          zI      += std::imag(f);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;          n1      += <a class="code" href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#ae6b34a83db781b1a3b2e06ba27eacc0b">std::norm</a>(p1);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;          n2      += <a class="code" href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#ae6b34a83db781b1a3b2e06ba27eacc0b">std::norm</a>(p2);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        }</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="../../dc/d82/namespace_amp_gen.html#a0c4b038444f13769eb75a6ee5a22c3d1">complex_t</a> z2(zR,zI);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keyword">auto</span> arg = std::arg(z2);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="keywordflow">return</span> std::make_tuple( <a class="code" href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#a0e5654df62d05a37f80dd1eef361537a">std::abs</a>(z2/<a class="code" href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#a53b6df3ee3b23d32e7e96ee2fe2c431b">sqrt</a>(n1*n2)), 180 * ( arg &gt; 0 ? arg : 2*M_PI+arg) /M_PI, <a class="code" href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#a53b6df3ee3b23d32e7e96ee2fe2c431b">sqrt</a>(n1/n2) );</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      } </div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html#acce19583f57c1cf2e4f3da14e8798f0a">   40</a></span>&#160;    <a class="code" href="../../d8/d85/class_psi3770.html#acce19583f57c1cf2e4f3da14e8798f0a">Psi3770</a>(<a class="code" href="../../d5/dc6/struct_model_store.html">ModelStore</a>&amp; models,</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d7/dfa/class_amp_gen_1_1_event_type.html">EventType</a>&amp; signalType, </div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d7/dfa/class_amp_gen_1_1_event_type.html">EventType</a>&amp; tagType) :</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      m_signalType(signalType)                  ,</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      m_tagType   (tagType)                     ,</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      m_signal    (models.find&lt;T1&gt;(m_signalType)),</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      m_signalBar (models.find&lt;T1&gt;(m_signalType.<a class="code" href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#af3433de0bb6eb0174187ac19b28c653f">conj</a>(true))),</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      m_tag       (models.find&lt;T2&gt;(m_tagType))              ,</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      m_tagBar    (models.find&lt;T2&gt;(m_tagType.<a class="code" href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#af3433de0bb6eb0174187ac19b28c653f">conj</a>(true)))   ,</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      m_signalPhsp(m_signalType )               ,</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      m_tagPhsp   (m_tagType )                  ,</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      m_headPhsp  (<a class="code" href="../../d7/dfa/class_amp_gen_1_1_event_type.html">EventType</a>({<span class="stringliteral">&quot;psi(3770)0&quot;</span>,<span class="stringliteral">&quot;D0&quot;</span>,<span class="stringliteral">&quot;Dbar0&quot;</span>}))</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      { </div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <a class="code" href="../../dd/d89/group__msg_service.html#gac0e7ce4f5ccb0f16d1103330cce71abc">INFO</a>(<span class="stringliteral">&quot;Type         = &quot;</span> &lt;&lt; m_signalType  &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; m_tagType.<a class="code" href="../../d7/dfa/class_amp_gen_1_1_event_type.html#a445c3ed6299d38f1ffc3a78b288786e5">conj</a>(<span class="keyword">true</span>) &lt;&lt; <span class="stringliteral">&quot;] - [&quot;</span> &lt;&lt; m_signalType.<a class="code" href="../../d7/dfa/class_amp_gen_1_1_event_type.html#a445c3ed6299d38f1ffc3a78b288786e5">conj</a>(<span class="keyword">true</span>) &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; m_tagType &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keyword">auto</span> z1 = z(m_signal, m_signalBar, m_signalType);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keyword">auto</span> z2 = z(m_tag   , m_tagBar   , m_tagType);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="../../dd/d89/group__msg_service.html#gac0e7ce4f5ccb0f16d1103330cce71abc">INFO</a>( <span class="stringliteral">&quot;Signal: R = &quot;</span> &lt;&lt; <a class="code" href="../../dc/d82/namespace_amp_gen.html#a5cbb174b88e932b17f60865e9372b9aa">round</a>(std::get&lt;0&gt;(z1),5) &lt;&lt; <span class="stringliteral">&quot;; δ = &quot;</span> &lt;&lt; <a class="code" href="../../dc/d82/namespace_amp_gen.html#a5cbb174b88e932b17f60865e9372b9aa">round</a>(std::get&lt;1&gt;(z1),3) &lt;&lt; <span class="stringliteral">&quot;° ; r = &quot;</span> &lt;&lt; <a class="code" href="../../dc/d82/namespace_amp_gen.html#a5cbb174b88e932b17f60865e9372b9aa">round</a>(std::get&lt;2&gt;(z1),5) );</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <a class="code" href="../../dd/d89/group__msg_service.html#gac0e7ce4f5ccb0f16d1103330cce71abc">INFO</a>( <span class="stringliteral">&quot;Tag   : R = &quot;</span> &lt;&lt; <a class="code" href="../../dc/d82/namespace_amp_gen.html#a5cbb174b88e932b17f60865e9372b9aa">round</a>(std::get&lt;0&gt;(z2),5) &lt;&lt; <span class="stringliteral">&quot;; δ = &quot;</span> &lt;&lt; <a class="code" href="../../dc/d82/namespace_amp_gen.html#a5cbb174b88e932b17f60865e9372b9aa">round</a>(std::get&lt;1&gt;(z2),3) &lt;&lt; <span class="stringliteral">&quot;° ; r = &quot;</span> &lt;&lt; <a class="code" href="../../dc/d82/namespace_amp_gen.html#a5cbb174b88e932b17f60865e9372b9aa">round</a>(std::get&lt;2&gt;(z2),5) );</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      }</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html#accdff09051df3ee32ce02eb26ff727d8">   59</a></span>&#160;    <a class="code" href="../../dc/d82/namespace_amp_gen.html#a0c4b038444f13769eb75a6ee5a22c3d1">complex_t</a> <a class="code" href="../../d8/d85/class_psi3770.html#accdff09051df3ee32ce02eb26ff727d8">operator()</a>(<span class="keyword">const</span> <a class="code" href="../../db/d08/struct_d_t_event.html">DTEvent</a>&amp; event )<span class="keyword">                 const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d8/d85/class_psi3770.html#accdff09051df3ee32ce02eb26ff727d8">operator()</a>( event.<a class="code" href="../../db/d08/struct_d_t_event.html#a125de04bc0ed023183097055e41d2d1f">signal</a>, event.<a class="code" href="../../db/d08/struct_d_t_event.html#ab6ca22c3abf5dd25cd3055b963b586eb">tag</a> ); }</div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html#a5771154379c8a0273f34a5993fa02ba7">   60</a></span>&#160;    <a class="code" href="../../dc/d82/namespace_amp_gen.html#a0c4b038444f13769eb75a6ee5a22c3d1">complex_t</a> <a class="code" href="../../d8/d85/class_psi3770.html#a5771154379c8a0273f34a5993fa02ba7">operator()</a>(<span class="keyword">const</span> <a class="code" href="../../dd/dc4/class_amp_gen_1_1_event.html">Event</a>&amp; signal, <span class="keyword">const</span> <a class="code" href="../../dd/dc4/class_amp_gen_1_1_event.html">Event</a>&amp; tag)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_signal(signal)*m_tagBar(tag) - m_signalBar(signal) * m_tag(tag); }</div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html#a157b1f2437df1abbeff0ad0c35a35c63">   61</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d8/d85/class_psi3770.html#a157b1f2437df1abbeff0ad0c35a35c63">P</a>(<span class="keyword">const</span> <a class="code" href="../../db/d08/struct_d_t_event.html">DTEvent</a>&amp; event)<span class="keyword">                              const </span>{ <span class="keywordflow">return</span> m_ignoreQc ? prob_noQC(event) : <a class="code" href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#ae6b34a83db781b1a3b2e06ba27eacc0b">std::norm</a>(<span class="keyword">operator</span>()(event)); }</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html#ae3f6df2211685163e151e06ffb5d91c3">   62</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d8/d85/class_psi3770.html#ae3f6df2211685163e151e06ffb5d91c3">prob_noQC</a> (<span class="keyword">const</span> <a class="code" href="../../db/d08/struct_d_t_event.html">DTEvent</a>&amp; event)<span class="keyword">                     const </span>{ <span class="keywordflow">return</span> <a class="code" href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#ae6b34a83db781b1a3b2e06ba27eacc0b">std::norm</a>(m_signal(event.<a class="code" href="../../db/d08/struct_d_t_event.html#a125de04bc0ed023183097055e41d2d1f">signal</a>)*m_tagBar(event.<a class="code" href="../../db/d08/struct_d_t_event.html#ab6ca22c3abf5dd25cd3055b963b586eb">tag</a>)) + <a class="code" href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#ae6b34a83db781b1a3b2e06ba27eacc0b">std::norm</a>(m_signalBar(event.<a class="code" href="../../db/d08/struct_d_t_event.html#a125de04bc0ed023183097055e41d2d1f">signal</a>)*m_tag(event.<a class="code" href="../../db/d08/struct_d_t_event.html#ab6ca22c3abf5dd25cd3055b963b586eb">tag</a>)); } </div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html#ad455ad755fbb3aea77da4fa30f6747cb">   63</a></span>&#160;    std::complex&lt;double&gt; <a class="code" href="../../d8/d85/class_psi3770.html#ad455ad755fbb3aea77da4fa30f6747cb">fSig</a>(<span class="keyword">const</span> <a class="code" href="../../db/d08/struct_d_t_event.html">DTEvent</a>&amp; event)<span class="keyword">             const </span>{<span class="keywordflow">return</span> m_signal(event.<a class="code" href="../../db/d08/struct_d_t_event.html#a125de04bc0ed023183097055e41d2d1f">signal</a>);}</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html#aed2d06fb2aa8eb4bb87e42a1436a056c">   64</a></span>&#160;    std::complex&lt;double&gt; <a class="code" href="../../d8/d85/class_psi3770.html#aed2d06fb2aa8eb4bb87e42a1436a056c">fSigCC</a>(<span class="keyword">const</span> <a class="code" href="../../db/d08/struct_d_t_event.html">DTEvent</a>&amp; event)<span class="keyword">             const </span>{<span class="keywordflow">return</span> m_signalBar(event.<a class="code" href="../../db/d08/struct_d_t_event.html#a125de04bc0ed023183097055e41d2d1f">signal</a>);}</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html#ac3bd2174d000411b0a95992a7d8abbcc">   65</a></span>&#160;    std::complex&lt;double&gt; <a class="code" href="../../d8/d85/class_psi3770.html#ac3bd2174d000411b0a95992a7d8abbcc">fTag</a>(<span class="keyword">const</span> <a class="code" href="../../db/d08/struct_d_t_event.html">DTEvent</a>&amp; event)<span class="keyword">             const </span>{<span class="keywordflow">return</span> m_tag(event.<a class="code" href="../../db/d08/struct_d_t_event.html#ab6ca22c3abf5dd25cd3055b963b586eb">tag</a>);}</div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html#abc001600495b7fffd9c3b590b3afde3e">   66</a></span>&#160;    std::complex&lt;double&gt; <a class="code" href="../../d8/d85/class_psi3770.html#abc001600495b7fffd9c3b590b3afde3e">fTagCC</a>(<span class="keyword">const</span> <a class="code" href="../../db/d08/struct_d_t_event.html">DTEvent</a>&amp; event)<span class="keyword">             const </span>{<span class="keywordflow">return</span> m_tagBar(event.<a class="code" href="../../db/d08/struct_d_t_event.html#ab6ca22c3abf5dd25cd3055b963b586eb">tag</a>);}</div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html#a35c247bd3fba1d0c78d2810b5990f2a8">   67</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d8/d85/class_psi3770.html#a35c247bd3fba1d0c78d2810b5990f2a8">sigS</a> (<span class="keyword">const</span> <a class="code" href="../../db/d08/struct_d_t_event.html">DTEvent</a>&amp; event, <span class="keyword">const</span> std::vector&lt;unsigned&gt;&amp; ind)<span class="keyword">  const </span>{<span class="keywordflow">return</span> <span class="keyword">event</span>.signal.s(ind);}</div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html#a98017bd0c94a2f58aaf22dbc2ed1cfae">   68</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d8/d85/class_psi3770.html#a98017bd0c94a2f58aaf22dbc2ed1cfae">tagS</a> (<span class="keyword">const</span> <a class="code" href="../../db/d08/struct_d_t_event.html">DTEvent</a>&amp; event, <span class="keyword">const</span> std::vector&lt;unsigned&gt;&amp; ind)<span class="keyword">  const </span>{<span class="keywordflow">return</span> <span class="keyword">event</span>.tag.s(ind);}</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html#a14094e3675ff6761d5738860c5380d24">   70</a></span>&#160;    <a class="code" href="../../db/d08/struct_d_t_event.html">DTEvent</a> <a class="code" href="../../d8/d85/class_psi3770.html#a14094e3675ff6761d5738860c5380d24">generatePhaseSpace</a>()                                      { <span class="keywordflow">return</span> <a class="code" href="../../db/d08/struct_d_t_event.html">DTEvent</a>( m_signalPhsp.<a class="code" href="../../d6/d53/class_amp_gen_1_1_phase_space.html#ad288147c0e7f196c1f7a566403fcee3d">makeEvent</a>(), m_tagPhsp.<a class="code" href="../../d6/d53/class_amp_gen_1_1_phase_space.html#ad288147c0e7f196c1f7a566403fcee3d">makeEvent</a>() ); }</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html#adebd9d4cbbb5fe66e0151529a615b1c5">   71</a></span>&#160;    <a class="code" href="../../d8/d40/struct_amp_gen_1_1_d_t_event_list.html">DTEventList</a> <a class="code" href="../../d8/d85/class_psi3770.html#adebd9d4cbbb5fe66e0151529a615b1c5">generate</a>( <span class="keyword">const</span> <span class="keywordtype">size_t</span>&amp; N )</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <a class="code" href="../../d8/d40/struct_amp_gen_1_1_d_t_event_list.html">DTEventList</a> output( m_signalType, m_tagType );</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <a class="code" href="../../d1/de8/class_amp_gen_1_1_progress_bar.html">ProgressBar</a> pb(60, <a class="code" href="../../d9/daa/_msg_service_8h.html#a6dcb94fde52e886851b2ac2ffd0af506">trimmedString</a>(__PRETTY_FUNCTION__));</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keyword">auto</span> tStartTotal = std::chrono::high_resolution_clock::now();</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordtype">int</span> currentSize  = 0;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#ae6b34a83db781b1a3b2e06ba27eacc0b">norm</a>      = -1;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">while</span>( output.size() &lt; N ){</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keyword">auto</span> events = generatePHSP(m_blockSize);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">if</span>(norm == -1 ){</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;          <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; event : events) <span class="keywordflow">if</span>(event.prob &gt; norm ) norm = <span class="keyword">event</span>.prob;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;          norm *= 1.5;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;          <a class="code" href="../../dd/d89/group__msg_service.html#gac0e7ce4f5ccb0f16d1103330cce71abc">INFO</a>(<span class="stringliteral">&quot;Calculated normalisation of PDF = &quot;</span> &lt;&lt; norm );</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">auto</span>&amp; event : events ){</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;          <span class="keywordflow">if</span>( event.prob &gt; norm * gRandom-&gt;Uniform() ) output.push_back( event ); </div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;          <span class="keywordflow">if</span>( output.size() &gt;= N ) <span class="keywordflow">break</span> ; </div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordtype">double</span> efficiency = 100 * double(output.size() - currentSize )/<span class="keywordtype">double</span>(m_blockSize);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordtype">double</span> time = std::chrono::duration&lt;double, std::milli&gt;( std::chrono::high_resolution_clock::now() - tStartTotal ).count();</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        pb.<a class="code" href="../../d1/de8/class_amp_gen_1_1_progress_bar.html#a310f71477be33d2542bae2361916c3d3">print</a>( <span class="keywordtype">double</span>(output.size()) / <span class="keywordtype">double</span>(N), <span class="stringliteral">&quot; ε[gen] = &quot;</span> + <a class="code" href="../../dc/d82/namespace_amp_gen.html#ad91ebe5cf182f4eb38ac8fad676ceac5">mysprintf</a>(<span class="stringliteral">&quot;%.2f&quot;</span>,efficiency) + <span class="stringliteral">&quot;% , &quot;</span> + <a class="code" href="../../dc/d82/namespace_amp_gen.html#a11a5e5e4977c3441c23e176f5e50d1ad">std::to_string</a>(<span class="keywordtype">int</span>(time/1000.))  + <span class="stringliteral">&quot; seconds&quot;</span> );</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        currentSize = output.size();</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="keyword">auto</span> psi_q = <a class="code" href="../../d6/d53/class_amp_gen_1_1_phase_space.html">PhaseSpace</a>(m_headPhsp); </div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keyword">auto</span> beta  = [](<span class="keyword">const</span> <a class="code" href="../../dd/dc4/class_amp_gen_1_1_event.html">Event</a>&amp; event, <span class="keyword">const</span> <span class="keywordtype">size_t</span>&amp;j){ <span class="keywordflow">return</span> <a class="code" href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#a53b6df3ee3b23d32e7e96ee2fe2c431b">sqrt</a>( event[4*j+0]*event[4*j+0] + event[4*j+1]*event[4*j+1] + event[4*j+2]*event[4*j+2] )/<span class="keyword">event</span>[4*j+3] ; };</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keyword">auto</span> p     = [](<span class="keyword">const</span> <a class="code" href="../../dd/dc4/class_amp_gen_1_1_event.html">Event</a>&amp; event, <span class="keyword">const</span> <span class="keywordtype">size_t</span>&amp;j){ <span class="keywordflow">return</span> std::make_tuple(event[4*j+0], event[4*j+1], event[4*j+2]); };</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordflow">for</span>( <span class="keyword">auto</span>&amp; event : output ){</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keyword">auto</span> psi_event = psi_q.makeEvent();</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="../../dc/d82/namespace_amp_gen.html#a083459d800d145e48ad06399626e8f49">boost</a>( event.signal, p(psi_event,0), beta(psi_event,0));</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <a class="code" href="../../dc/d82/namespace_amp_gen.html#a083459d800d145e48ad06399626e8f49">boost</a>( event.tag   , p(psi_event,1), beta(psi_event,1));</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordtype">double</span> time = std::chrono::duration&lt;double, std::milli&gt;( std::chrono::high_resolution_clock::now() - tStartTotal ).count();</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      pb.<a class="code" href="../../d1/de8/class_amp_gen_1_1_progress_bar.html#a9dd23a0a26c8f6774cbcb9778e9e3c37">finish</a>();</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <a class="code" href="../../dd/d89/group__msg_service.html#gac0e7ce4f5ccb0f16d1103330cce71abc">INFO</a>(<span class="stringliteral">&quot;Requested: &quot;</span> &lt;&lt; N &lt;&lt; <span class="stringliteral">&quot; events t=&quot;</span> &lt;&lt; time/1000 &lt;&lt; <span class="stringliteral">&quot;[ms]&quot;</span>);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">return</span> output;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html#aabfd20d2c615ea809e39c9fd17252121">  107</a></span>&#160;    <a class="code" href="../../d8/d40/struct_amp_gen_1_1_d_t_event_list.html">DTEventList</a> <a class="code" href="../../d8/d85/class_psi3770.html#aabfd20d2c615ea809e39c9fd17252121">generatePHSP</a>(<span class="keyword">const</span> <span class="keywordtype">size_t</span>&amp; N, <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; eval=<span class="keyword">true</span>){</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <a class="code" href="../../d8/d40/struct_amp_gen_1_1_d_t_event_list.html">DTEventList</a> output( m_signalType, m_tagType );</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> x = 0 ; x &lt; m_blockSize; ++x) output.emplace_back( generatePhaseSpace() ); </div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">      #pragma omp parallel for</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0 ; i &lt; m_blockSize; ++i ) output[i].prob = P(output[i]);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">return</span> output;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="../../d8/d85/class_psi3770.html#a11d342341a6a65b3e9934fb42736d619">  114</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d8/d85/class_psi3770.html#a11d342341a6a65b3e9934fb42736d619">rho</a>() {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordflow">if</span>( m_ignoreQc ) <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordtype">double</span> withQC=0;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keywordtype">double</span> withoutQC =0;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <a class="code" href="../../d8/d40/struct_amp_gen_1_1_d_t_event_list.html">DTEventList</a> evts = generatePHSP(m_blockSize, <span class="keyword">false</span>); </div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">      #pragma omp parallel for reduction(+:withQC,withoutQC)</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> x = 0; x&lt;m_blockSize; ++x ){</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keyword">auto</span> <span class="keyword">event</span>   = evts[x]; </div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        withQC    += P(event);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        withoutQC += prob_noQC(event);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">return</span> withQC / withoutQC ;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;};</div><div class="ttc" id="class_amp_gen_1_1_phase_space_html"><div class="ttname"><a href="../../d6/d53/class_amp_gen_1_1_phase_space.html">AmpGen::PhaseSpace</a></div><div class="ttdoc">Phase-space generator taken from the ROOT routine, from Rene Brun and Valerio Filippini, which was originally based on the GENBOD routine of CERNLIB with modifications such that unweighted events are generated, which saves a large amount of CPU. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5e/_phase_space_8h_source.html#l00022">PhaseSpace.h:22</a></div></div>
<div class="ttc" id="class_psi3770_html_a14094e3675ff6761d5738860c5380d24"><div class="ttname"><a href="../../d8/d85/class_psi3770.html#a14094e3675ff6761d5738860c5380d24">Psi3770::generatePhaseSpace</a></div><div class="ttdeci">DTEvent generatePhaseSpace()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00070">Psi3770.h:70</a></div></div>
<div class="ttc" id="class_psi3770_html_a157b1f2437df1abbeff0ad0c35a35c63"><div class="ttname"><a href="../../d8/d85/class_psi3770.html#a157b1f2437df1abbeff0ad0c35a35c63">Psi3770::P</a></div><div class="ttdeci">double P(const DTEvent &amp;event) const </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00061">Psi3770.h:61</a></div></div>
<div class="ttc" id="class_psi3770_html_aed2d06fb2aa8eb4bb87e42a1436a056c"><div class="ttname"><a href="../../d8/d85/class_psi3770.html#aed2d06fb2aa8eb4bb87e42a1436a056c">Psi3770::fSigCC</a></div><div class="ttdeci">std::complex&lt; double &gt; fSigCC(const DTEvent &amp;event) const </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00064">Psi3770.h:64</a></div></div>
<div class="ttc" id="namespace_amp_gen_1_1fcn_html_a53b6df3ee3b23d32e7e96ee2fe2c431b"><div class="ttname"><a href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#a53b6df3ee3b23d32e7e96ee2fe2c431b">AmpGen::fcn::sqrt</a></div><div class="ttdeci">Expression sqrt(const Expression &amp;expression)</div></div>
<div class="ttc" id="class_psi3770_html_acce19583f57c1cf2e4f3da14e8798f0a"><div class="ttname"><a href="../../d8/d85/class_psi3770.html#acce19583f57c1cf2e4f3da14e8798f0a">Psi3770::Psi3770</a></div><div class="ttdeci">Psi3770(ModelStore &amp;models, const EventType &amp;signalType, const EventType &amp;tagType)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00040">Psi3770.h:40</a></div></div>
<div class="ttc" id="class_amp_gen_1_1_generator_html"><div class="ttname"><a href="../../de/d94/class_amp_gen_1_1_generator.html">AmpGen::Generator</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc5/_generator_8h_source.html#l00014">Generator.h:14</a></div></div>
<div class="ttc" id="struct_amp_gen_1_1_d_t_event_list_html"><div class="ttname"><a href="../../d8/d40/struct_amp_gen_1_1_d_t_event_list.html">AmpGen::DTEventList</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dea/_d_t_event_list_8h_source.html#l00006">DTEventList.h:6</a></div></div>
<div class="ttc" id="class_psi3770_html_ac3bd2174d000411b0a95992a7d8abbcc"><div class="ttname"><a href="../../d8/d85/class_psi3770.html#ac3bd2174d000411b0a95992a7d8abbcc">Psi3770::fTag</a></div><div class="ttdeci">std::complex&lt; double &gt; fTag(const DTEvent &amp;event) const </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00065">Psi3770.h:65</a></div></div>
<div class="ttc" id="namespacestd_1_1complex__literals_html"><div class="ttname"><a href="../../da/df3/namespacestd_1_1complex__literals.html">complex_literals</a></div></div>
<div class="ttc" id="class_psi3770_html_abc001600495b7fffd9c3b590b3afde3e"><div class="ttname"><a href="../../d8/d85/class_psi3770.html#abc001600495b7fffd9c3b590b3afde3e">Psi3770::fTagCC</a></div><div class="ttdeci">std::complex&lt; double &gt; fTagCC(const DTEvent &amp;event) const </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00066">Psi3770.h:66</a></div></div>
<div class="ttc" id="namespace_amp_gen_html"><div class="ttname"><a href="../../dc/d82/namespace_amp_gen.html">AmpGen</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d1b/_add_c_p_conjugate_8h_source.html#l00002">AddCPConjugate.h:2</a></div></div>
<div class="ttc" id="_normalised_pdf_8h_html"><div class="ttname"><a href="../../d7/d23/_normalised_pdf_8h.html">NormalisedPdf.h</a></div></div>
<div class="ttc" id="namespace_amp_gen_html_a11a5e5e4977c3441c23e176f5e50d1ad"><div class="ttname"><a href="../../dc/d82/namespace_amp_gen.html#a11a5e5e4977c3441c23e176f5e50d1ad">AmpGen::to_string</a></div><div class="ttdeci">std::string to_string(const T &amp;enumItem)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d9b/enum_8h_source.html#l00026">enum.h:26</a></div></div>
<div class="ttc" id="class_psi3770_html_ad455ad755fbb3aea77da4fa30f6747cb"><div class="ttname"><a href="../../d8/d85/class_psi3770.html#ad455ad755fbb3aea77da4fa30f6747cb">Psi3770::fSig</a></div><div class="ttdeci">std::complex&lt; double &gt; fSig(const DTEvent &amp;event) const </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00063">Psi3770.h:63</a></div></div>
<div class="ttc" id="namespace_amp_gen_html_a5cbb174b88e932b17f60865e9372b9aa"><div class="ttname"><a href="../../dc/d82/namespace_amp_gen.html#a5cbb174b88e932b17f60865e9372b9aa">AmpGen::round</a></div><div class="ttdeci">std::string round(const double &amp;number, const unsigned int &amp;nsf)</div></div>
<div class="ttc" id="namespace_amp_gen_1_1fcn_html_a0e5654df62d05a37f80dd1eef361537a"><div class="ttname"><a href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#a0e5654df62d05a37f80dd1eef361537a">AmpGen::fcn::abs</a></div><div class="ttdeci">Expression abs(const Expression &amp;expression)</div></div>
<div class="ttc" id="class_amp_gen_1_1_event_html"><div class="ttname"><a href="../../dd/dc4/class_amp_gen_1_1_event.html">AmpGen::Event</a></div><div class="ttdoc">Encapsulates the final state particles of a single event. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d6d/_event_8h_source.html#l00018">Event.h:18</a></div></div>
<div class="ttc" id="class_psi3770_html_a5771154379c8a0273f34a5993fa02ba7"><div class="ttname"><a href="../../d8/d85/class_psi3770.html#a5771154379c8a0273f34a5993fa02ba7">Psi3770::operator()</a></div><div class="ttdeci">complex_t operator()(const Event &amp;signal, const Event &amp;tag) const </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00060">Psi3770.h:60</a></div></div>
<div class="ttc" id="_msg_service_8h_html_a6dcb94fde52e886851b2ac2ffd0af506"><div class="ttname"><a href="../../d9/daa/_msg_service_8h.html#a6dcb94fde52e886851b2ac2ffd0af506">trimmedString</a></div><div class="ttdeci">std::string trimmedString(std::string thing, const unsigned int &amp;length=45)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daa/_msg_service_8h_source.html#l00023">MsgService.h:23</a></div></div>
<div class="ttc" id="class_psi3770_html_a35c247bd3fba1d0c78d2810b5990f2a8"><div class="ttname"><a href="../../d8/d85/class_psi3770.html#a35c247bd3fba1d0c78d2810b5990f2a8">Psi3770::sigS</a></div><div class="ttdeci">double sigS(const DTEvent &amp;event, const std::vector&lt; unsigned &gt; &amp;ind) const </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00067">Psi3770.h:67</a></div></div>
<div class="ttc" id="class_psi3770_html_adebd9d4cbbb5fe66e0151529a615b1c5"><div class="ttname"><a href="../../d8/d85/class_psi3770.html#adebd9d4cbbb5fe66e0151529a615b1c5">Psi3770::generate</a></div><div class="ttdeci">DTEventList generate(const size_t &amp;N)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00071">Psi3770.h:71</a></div></div>
<div class="ttc" id="structnormalised__pdf_html"><div class="ttname"><a href="../../d5/de1/structnormalised__pdf.html">normalised_pdf&lt; T1 &gt;</a></div></div>
<div class="ttc" id="struct_d_t_event_html_a125de04bc0ed023183097055e41d2d1f"><div class="ttname"><a href="../../db/d08/struct_d_t_event.html#a125de04bc0ed023183097055e41d2d1f">DTEvent::signal</a></div><div class="ttdeci">AmpGen::Event signal</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d56/_d_t_event_8h_source.html#l00043">DTEvent.h:43</a></div></div>
<div class="ttc" id="namespace_amp_gen_1_1fcn_html_af3433de0bb6eb0174187ac19b28c653f"><div class="ttname"><a href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#af3433de0bb6eb0174187ac19b28c653f">AmpGen::fcn::conj</a></div><div class="ttdeci">Expression conj(const Expression &amp;expression)</div></div>
<div class="ttc" id="namespace_amp_gen_1_1fcn_html_ae6b34a83db781b1a3b2e06ba27eacc0b"><div class="ttname"><a href="../../d4/dc7/namespace_amp_gen_1_1fcn.html#ae6b34a83db781b1a3b2e06ba27eacc0b">AmpGen::fcn::norm</a></div><div class="ttdeci">Expression norm(const Expression &amp;expression)</div></div>
<div class="ttc" id="class_amp_gen_1_1_progress_bar_html"><div class="ttname"><a href="../../d1/de8/class_amp_gen_1_1_progress_bar.html">AmpGen::ProgressBar</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d9c/_progress_bar_8h_source.html#l00006">ProgressBar.h:6</a></div></div>
<div class="ttc" id="class_psi3770_html_a11d342341a6a65b3e9934fb42736d619"><div class="ttname"><a href="../../d8/d85/class_psi3770.html#a11d342341a6a65b3e9934fb42736d619">Psi3770::rho</a></div><div class="ttdeci">double rho()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00114">Psi3770.h:114</a></div></div>
<div class="ttc" id="class_psi3770_html_accdff09051df3ee32ce02eb26ff727d8"><div class="ttname"><a href="../../d8/d85/class_psi3770.html#accdff09051df3ee32ce02eb26ff727d8">Psi3770::operator()</a></div><div class="ttdeci">complex_t operator()(const DTEvent &amp;event) const </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00059">Psi3770.h:59</a></div></div>
<div class="ttc" id="class_psi3770_html_aa81e9b7036fcfb9ad9c0b7dfe176dbaa"><div class="ttname"><a href="../../d8/d85/class_psi3770.html#aa81e9b7036fcfb9ad9c0b7dfe176dbaa">Psi3770::z</a></div><div class="ttdeci">std::tuple&lt; double, double, double &gt; z(T &amp;t1, T &amp;t2, const EventType &amp;type) const </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00022">Psi3770.h:22</a></div></div>
<div class="ttc" id="class_amp_gen_1_1_progress_bar_html_a9dd23a0a26c8f6774cbcb9778e9e3c37"><div class="ttname"><a href="../../d1/de8/class_amp_gen_1_1_progress_bar.html#a9dd23a0a26c8f6774cbcb9778e9e3c37">AmpGen::ProgressBar::finish</a></div><div class="ttdeci">void finish()</div></div>
<div class="ttc" id="class_psi3770_html_ae3f6df2211685163e151e06ffb5d91c3"><div class="ttname"><a href="../../d8/d85/class_psi3770.html#ae3f6df2211685163e151e06ffb5d91c3">Psi3770::prob_noQC</a></div><div class="ttdeci">double prob_noQC(const DTEvent &amp;event) const </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00062">Psi3770.h:62</a></div></div>
<div class="ttc" id="class_amp_gen_1_1_named_parameter_html"><div class="ttname"><a href="../../d9/d1b/class_amp_gen_1_1_named_parameter.html">AmpGen::NamedParameter</a></div><div class="ttdoc">A parameter with value specified by the user at runtime, either in an options file or via the command...</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d78/_named_parameter_8h_source.html#l00031">NamedParameter.h:31</a></div></div>
<div class="ttc" id="struct_d_t_event_html"><div class="ttname"><a href="../../db/d08/struct_d_t_event.html">DTEvent</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d56/_d_t_event_8h_source.html#l00041">DTEvent.h:41</a></div></div>
<div class="ttc" id="namespace_amp_gen_html_ad91ebe5cf182f4eb38ac8fad676ceac5"><div class="ttname"><a href="../../dc/d82/namespace_amp_gen.html#ad91ebe5cf182f4eb38ac8fad676ceac5">AmpGen::mysprintf</a></div><div class="ttdeci">std::string mysprintf(const std::string &amp;format, ARGS &amp;&amp;...args)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d72/_utilities_8h_source.html#l00093">Utilities.h:93</a></div></div>
<div class="ttc" id="namespace_amp_gen_html_a0c4b038444f13769eb75a6ee5a22c3d1"><div class="ttname"><a href="../../dc/d82/namespace_amp_gen.html#a0c4b038444f13769eb75a6ee5a22c3d1">AmpGen::complex_t</a></div><div class="ttdeci">std::complex&lt; real_t &gt; complex_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db6/_types_8h_source.html#l00007">Types.h:7</a></div></div>
<div class="ttc" id="class_amp_gen_1_1_progress_bar_html_a310f71477be33d2542bae2361916c3d3"><div class="ttname"><a href="../../d1/de8/class_amp_gen_1_1_progress_bar.html#a310f71477be33d2542bae2361916c3d3">AmpGen::ProgressBar::print</a></div><div class="ttdeci">void print(const double &amp;percentage, const std::string &amp;message=&quot;&quot;)</div></div>
<div class="ttc" id="class_psi3770_html_aabfd20d2c615ea809e39c9fd17252121"><div class="ttname"><a href="../../d8/d85/class_psi3770.html#aabfd20d2c615ea809e39c9fd17252121">Psi3770::generatePHSP</a></div><div class="ttdeci">DTEventList generatePHSP(const size_t &amp;N, const bool &amp;eval=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00107">Psi3770.h:107</a></div></div>
<div class="ttc" id="class_amp_gen_1_1_phase_space_html_ad288147c0e7f196c1f7a566403fcee3d"><div class="ttname"><a href="../../d6/d53/class_amp_gen_1_1_phase_space.html#ad288147c0e7f196c1f7a566403fcee3d">AmpGen::PhaseSpace::makeEvent</a></div><div class="ttdeci">Event makeEvent(const size_t &amp;cacheSize=0)</div><div class="ttdoc">Make an event in this phase space. </div></div>
<div class="ttc" id="class_amp_gen_1_1_event_type_html"><div class="ttname"><a href="../../d7/dfa/class_amp_gen_1_1_event_type.html">AmpGen::EventType</a></div><div class="ttdoc">Deals with final state configuration of events, specifically dealing with the ordering of particles i...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d69/_event_type_8h_source.html#l00019">EventType.h:19</a></div></div>
<div class="ttc" id="class_psi3770_html"><div class="ttname"><a href="../../d8/d85/class_psi3770.html">Psi3770</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00006">Psi3770.h:6</a></div></div>
<div class="ttc" id="struct_model_store_html"><div class="ttname"><a href="../../d5/dc6/struct_model_store.html">ModelStore</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d23/_normalised_pdf_8h_source.html#l00068">NormalisedPdf.h:68</a></div></div>
<div class="ttc" id="group__msg_service_html_gac0e7ce4f5ccb0f16d1103330cce71abc"><div class="ttname"><a href="../../dd/d89/group__msg_service.html#gac0e7ce4f5ccb0f16d1103330cce71abc">INFO</a></div><div class="ttdeci">#define INFO(X)</div><div class="ttdoc">Used for printing information messages, and will always be printed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/daa/_msg_service_8h_source.html#l00058">MsgService.h:58</a></div></div>
<div class="ttc" id="namespace_amp_gen_html_a083459d800d145e48ad06399626e8f49"><div class="ttname"><a href="../../dc/d82/namespace_amp_gen.html#a083459d800d145e48ad06399626e8f49">AmpGen::boost</a></div><div class="ttdeci">void boost(Event &amp;evt, const std::tuple&lt; double, double, double &gt; &amp;n, const double &amp;v)</div></div>
<div class="ttc" id="class_psi3770_html_a98017bd0c94a2f58aaf22dbc2ed1cfae"><div class="ttname"><a href="../../d8/d85/class_psi3770.html#a98017bd0c94a2f58aaf22dbc2ed1cfae">Psi3770::tagS</a></div><div class="ttdeci">double tagS(const DTEvent &amp;event, const std::vector&lt; unsigned &gt; &amp;ind) const </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d66/_psi3770_8h_source.html#l00068">Psi3770.h:68</a></div></div>
<div class="ttc" id="class_amp_gen_1_1_event_type_html_a445c3ed6299d38f1ffc3a78b288786e5"><div class="ttname"><a href="../../d7/dfa/class_amp_gen_1_1_event_type.html#a445c3ed6299d38f1ffc3a78b288786e5">AmpGen::EventType::conj</a></div><div class="ttdeci">EventType conj(const bool &amp;headOnly=0, const bool &amp;dontConjHead=0) const </div><div class="ttdoc">Returns the CP-conjugated event type. </div></div>
<div class="ttc" id="struct_d_t_event_html_ab6ca22c3abf5dd25cd3055b963b586eb"><div class="ttname"><a href="../../db/d08/struct_d_t_event.html#ab6ca22c3abf5dd25cd3055b963b586eb">DTEvent::tag</a></div><div class="ttdeci">AmpGen::Event tag</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d56/_d_t_event_8h_source.html#l00044">DTEvent.h:44</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_afe841426323c02de63fa29102dfa844.html">AmpGen</a></li><li class="navelem"><a class="el" href="../../dd/d66/_psi3770_8h.html">Psi3770.h</a></li>
    <li class="footer">Generated on Tue Nov 17 2020 12:19:55 for AmpGen by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
